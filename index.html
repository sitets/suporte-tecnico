<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Chatbox Suporte</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f0f0f0;
      margin: 0; padding: 0;
      display: flex; flex-direction: column; height: 100vh;
    }
    #chat {
      flex: 1;
      display: flex;
      flex-direction: column;
      max-width: 600px;
      margin: auto;
      background: white;
      border: 1px solid #ccc;
      border-radius: 5px;
    }
    #chatLog {
      flex: 1;
      padding: 10px;
      overflow-y: auto;
      border-bottom: 1px solid #ccc;
    }
    .msg {
      margin: 8px 0;
      max-width: 80%;
      padding: 8px 12px;
      border-radius: 15px;
      line-height: 1.4;
    }
    .user {
      background: #0084ff;
      color: white;
      align-self: flex-end;
      border-bottom-right-radius: 0;
    }
    .bot {
      background: #e5e5ea;
      color: #000;
      align-self: flex-start;
      border-bottom-left-radius: 0;
    }
    #inputArea {
      display: flex;
      padding: 10px;
      background: #fafafa;
    }
    #inputMsg {
      flex: 1;
      padding: 10px;
      font-size: 16px;
      border: 1px solid #ccc;
      border-radius: 20px;
      outline: none;
    }
    #sendBtn {
      padding: 10px 20px;
      margin-left: 10px;
      font-size: 16px;
      border: none;
      border-radius: 20px;
      background: #0084ff;
      color: white;
      cursor: pointer;
      transition: background 0.3s;
    }
    #sendBtn:hover {
      background: #006fcc;
    }
    a.chat-suggestion {
      color: #0084ff;
      cursor: pointer;
      text-decoration: underline;
      margin: 0 5px;
      font-weight: bold;
    }
    a.chat-suggestion:hover {
      color: #005999;
    }
  </style>
</head>
<body>
  <div id="chat">
    <div id="chatLog"></div>
    <form id="inputArea">
      <input type="text" id="inputMsg" placeholder="Digite sua mensagem..." autocomplete="off" />
      <button type="submit" id="sendBtn">Enviar</button>
    </form>
  </div>

  <script>
    const chatLog = document.getElementById('chatLog');
    const inputMsg = document.getElementById('inputMsg');
    const inputArea = document.getElementById('inputArea');

    // Variáveis para memória simples do contexto
    let contexto = null;  // guarda o tópico atual, ex: 'internet', 'lentidao', etc
    let esperandoEscolha = false;  // se o bot está esperando que o usuário escolha uma opção clicável

    // Mensagens ofensivas para filtro
    const mensagensOfensivas = ['burro', 'idiota', 'estúpido', 'inútil', 'imbecil', 'otário'];

    function contemPalavraOfensiva(texto) {
      texto = texto.toLowerCase();
      return mensagensOfensivas.some(palavra => texto.includes(palavra));
    }

    // Função para inserir mensagens no chat
    function adicionarMensagem(texto, remetente='user', html=false) {
      const msgElem = document.createElement('div');
      msgElem.classList.add('msg');
      msgElem.classList.add(remetente);
      if(html) {
        msgElem.innerHTML = texto;
      } else {
        msgElem.textContent = texto;
      }
      chatLog.appendChild(msgElem);
      chatLog.scrollTop = chatLog.scrollHeight;
    }

    // Função que cria links clicáveis para opções do usuário
    function criarSugestoes(lista) {
      return lista.map(item => `<a href="#" class="chat-suggestion" onclick="responderSugestao(event, '${item}')">${item}</a>`).join(' | ');
    }

    // Função para responder à escolha do usuário clicando na sugestão
    function responderSugestao(event, escolha) {
      event.preventDefault();
      if(esperandoEscolha) {
        adicionarMensagem(escolha, 'user');
        processarMensagem(escolha);
        esperandoEscolha = false;
      }
    }

    // Função que processa a mensagem do usuário e retorna a resposta do bot
    function processarMensagem(textoUsuario) {
      textoUsuario = textoUsuario.toLowerCase();

      if(contemPalavraOfensiva(textoUsuario)) {
        contexto = null;
        esperandoEscolha = false;
        adicionarMensagem("Por favor, mantenha o respeito. Estou aqui para ajudar.", 'bot');
        return;
      }

      // Saudações
      if(/^(oi|olá|ola|bom dia|boa tarde|boa noite|e aí|salve)/.test(textoUsuario)) {
        contexto = null;
        esperandoEscolha = false;
        adicionarMensagem("Olá! Sou seu assistente virtual. Em que posso ajudar hoje? Você pode perguntar sobre problemas de internet, lentidão, erros, hardware, software, vírus, impressora e mais.", 'bot');
        return;
      }

      // Despedidas
      if(/^(tchau|adeus|valeu|obrigado|brigado|até)/.test(textoUsuario)) {
        contexto = null;
        esperandoEscolha = false;
        adicionarMensagem("Obrigado por usar nosso suporte. Se precisar, volte sempre!", 'bot');
        return;
      }

      // Identificação de tópicos e resposta
      if(textoUsuario.includes('internet') || textoUsuario.includes('rede') || textoUsuario.includes('wi-fi')) {
        contexto = 'internet';
        esperandoEscolha = true;
        adicionarMensagem("Problemas com internet podem ter várias causas. Você quer ajuda com alguma dessas opções? " +
          criarSugestoes(['Reiniciar roteador', 'Configurar Wi-Fi', 'Verificar cabo', 'Outra coisa']), 'bot', true);
        return;
      }

      if(textoUsuario.includes('computador lento') || textoUsuario.includes('lentidão')) {
        contexto = 'lentidao';
        esperandoEscolha = true;
        adicionarMensagem("Computador lento pode ser causado por vários fatores. Deseja dicas para: " +
          criarSugestoes(['Limpar arquivos temporários', 'Verificar vírus', 'Desinstalar programas', 'Outra coisa']), 'bot', true);
        return;
      }

      if(textoUsuario.includes('erro') || textoUsuario.includes('problema')) {
        contexto = 'erro';
        esperandoEscolha = true;
        adicionarMensagem("Por favor, escolha uma categoria para o erro: " +
          criarSugestoes(['Tela azul', 'Tela preta', 'Programa fechando', 'Outro erro']), 'bot', true);
        return;
      }

      if(textoUsuario.includes('hardware') || textoUsuario.includes('peça') || textoUsuario.includes('placa') || textoUsuario.includes('fonte')) {
        contexto = 'hardware';
        esperandoEscolha = true;
        adicionarMensagem("Problemas de hardware podem variar. Deseja ajuda com: " +
          criarSugestoes(['Fonte', 'Placa-mãe', 'Memória RAM', 'Outro']), 'bot', true);
        return;
      }

      if(textoUsuario.includes('software') || textoUsuario.includes('programa') || textoUsuario.includes('app')) {
        contexto = 'software';
        esperandoEscolha = true;
        adicionarMensagem("Sobre software, você quer ajuda com: " +
          criarSugestoes(['Instalação', 'Remoção de vírus', 'Atualização', 'Outro']), 'bot', true);
        return;
      }

      if(textoUsuario.includes('vírus') || textoUsuario.includes('malware') || textoUsuario.includes('antivírus')) {
        contexto = 'virus';
        esperandoEscolha = true;
        adicionarMensagem("Vírus são sérios! Deseja ajuda para: " +
          criarSugestoes(['Escanear sistema', 'Remover vírus', 'Prevenção', 'Outro']), 'bot', true);
        return;
      }

      if(textoUsuario.includes('impressora')) {
        contexto = 'impressora';
        esperandoEscolha = true;
        adicionarMensagem("Problemas com impressora? Posso ajudar com: " +
          criarSugestoes(['Conectar', 'Driver', 'Fila de impressão', 'Outro']), 'bot', true);
        return;
      }

      // Se está esperando escolha, mas a mensagem não bate, lembra
      if(esperandoEscolha) {
        adicionarMensagem("Por favor, escolha uma das opções acima clicando nos links ou digite sua dúvida específica.", 'bot');
        return;
      }

      // Respostas baseadas em contexto e escolha

      switch(contexto) {
        case 'internet':
          if(textoUsuario.includes('reiniciar roteador')) {
            contexto = null; esperandoEscolha = false;
            adicionarMensagem("Para reiniciar o roteador, desligue-o da tomada, espere 30 segundos e ligue novamente. Isso resolve muitos problemas de conexão.", 'bot');
          } else if(textoUsuario.includes('configurar wi-fi')) {
            contexto = null; esperandoEscolha = false;
            adicionarMensagem("Para configurar o Wi-Fi, acesse as configurações do seu roteador via navegador e siga o manual do fabricante. Posso ajudar a encontrar o manual se quiser.", 'bot');
          } else if(textoUsuario.includes('verificar cabo')) {
            contexto = null; esperandoEscolha = false;
            adicionarMensagem("Verifique se o cabo de rede está conectado firmemente tanto no computador quanto no roteador/modem. Às vezes, um cabo danificado pode causar problemas.", 'bot');
          } else if(textoUsuario.includes('outra')) {
            contexto = null; esperandoEscolha = false;
            adicionarMensagem("Descreva seu problema com a internet que tentarei ajudar.", 'bot');
          } else {
            adicionarMensagem("Por favor, escolha uma das opções clicando nos links acima.", 'bot');
          }
          return;

        case 'lentidao':
          if(textoUsuario.includes('limpar')) {
            contexto = null; esperandoEscolha = false;
            adicionarMensagem("Para limpar arquivos temporários, utilize a ferramenta 'Limpeza de Disco' no Windows ou aplicativos específicos para isso.", 'bot');
          } else if(textoUsuario.includes('vírus')) {
            contexto = null; esperandoEscolha = false;
            adicionarMensagem("Faça um escaneamento completo com um antivírus atualizado para eliminar possíveis ameaças.", 'bot');
          } else if(textoUsuario.includes('desinstalar')) {
            contexto = null; esperandoEscolha = false;
            adicionarMensagem("Desinstale programas que você não utiliza para liberar recursos e melhorar a performance.", 'bot');
          } else if(textoUsuario.includes('outra')) {
            contexto = null; esperandoEscolha = false;
            adicionarMensagem("Por favor, descreva o problema para que eu possa ajudar melhor.", 'bot');
          } else {
            adicionarMensagem("Por favor, escolha uma das opções clicando nos links acima.", 'bot');
          }
          return;

        case 'erro':
          if(textoUsuario.includes('tela azul')) {
            contexto = null; esperandoEscolha = false;
            adicionarMensagem("A Tela Azul da Morte indica falha crítica. Tente anotar o código de erro e reinicie o computador. Atualizar drivers pode ajudar.", 'bot');
          } else if(textoUsuario.includes('tela preta')) {
            contexto = null; esperandoEscolha = false;
            adicionarMensagem("A Tela Preta pode indicar problemas de hardware ou software. Verifique as conexões e atualize seus drivers.", 'bot');
          } else if(textoUsuario.includes('programa fechando')) {
            contexto = null; esperandoEscolha = false;
            adicionarMensagem("Se um programa está fechando sozinho, tente reinstalá-lo ou verificar atualizações.", 'bot');
          } else if(textoUsuario.includes('outro')) {
            contexto = null; esperandoEscolha = false;
            adicionarMensagem("Descreva seu erro específico para que eu possa ajudar.", 'bot');
          } else {
            adicionarMensagem("Por favor, escolha uma das opções clicando nos links acima.", 'bot');
          }
          return;

        case 'hardware':
          if(textoUsuario.includes('fonte')) {
            contexto = null; esperandoEscolha = false;
            adicionarMensagem("Problemas na fonte podem causar desligamentos inesperados. Verifique a voltagem e cabos de energia.", 'bot');
          } else if(textoUsuario.includes('placa-mãe')) {
            contexto = null; esperandoEscolha = false;
            adicionarMensagem("Problemas na placa-mãe podem ser complexos. Verifique se há sinais visíveis de dano ou leve para assistência técnica.", 'bot');
          } else if(textoUsuario.includes('memória ram') || textoUsuario.includes('ram')) {
            contexto = null; esperandoEscolha = false;
            adicionarMensagem("Memória RAM com defeito pode causar erros e lentidão. Teste com ferramentas como MemTest86.", 'bot');
          } else if(textoUsuario.includes('outro')) {
            contexto = null; esperandoEscolha = false;
            adicionarMensagem("Descreva seu problema de hardware para que eu possa ajudar.", 'bot');
          } else {
            adicionarMensagem("Por favor, escolha uma das opções clicando nos links acima.", 'bot');
          }
          return;

        case 'software':
          if(textoUsuario.includes('instalação')) {
            contexto = null; esperandoEscolha = false;
            adicionarMensagem("Para instalar um software, baixe o arquivo oficial e siga as instruções do instalador.", 'bot');
          } else if(textoUsuario.includes('remoção de vírus') || textoUsuario.includes('vírus')) {
            contexto = null; esperandoEscolha = false;
            adicionarMensagem("Use um antivírus confiável para remover vírus e mantenha seu sistema atualizado.", 'bot');
          } else if(textoUsuario.includes('atualização')) {
            contexto = null; esperandoEscolha = false;
            adicionarMensagem("Atualize seus programas regularmente para garantir segurança e desempenho.", 'bot');
          } else if(textoUsuario.includes('outro')) {
            contexto = null; esperandoEscolha = false;
            adicionarMensagem("Descreva sua dúvida sobre software para que eu possa ajudar.", 'bot');
          } else {
            adicionarMensagem("Por favor, escolha uma das opções clicando nos links acima.", 'bot');
          }
          return;

        case 'virus':
          if(textoUsuario.includes('escanear')) {
            contexto = null; esperandoEscolha = false;
            adicionarMensagem("Para escanear o sistema, abra seu antivírus e faça uma varredura completa.", 'bot');
          } else if(textoUsuario.includes('remover')) {
            contexto = null; esperandoEscolha = false;
            adicionarMensagem("Se o antivírus identificar ameaças, siga as instruções para remover os vírus.", 'bot');
          } else if(textoUsuario.includes('prevenção')) {
            contexto = null; esperandoEscolha = false;
            adicionarMensagem("Mantenha seu antivírus atualizado e evite abrir arquivos suspeitos para prevenir vírus.", 'bot');
          } else if(textoUsuario.includes('outro')) {
            contexto = null; esperandoEscolha = false;
            adicionarMensagem("Descreva seu problema relacionado a vírus para que eu possa ajudar.", 'bot');
          } else {
            adicionarMensagem("Por favor, escolha uma das opções clicando nos links acima.", 'bot');
          }
          return;

        case 'impressora':
          if(textoUsuario.includes('conectar')) {
            contexto = null; esperandoEscolha = false;
            adicionarMensagem("Para conectar a impressora, verifique o cabo USB ou a conexão Wi-Fi e instale os drivers necessários.", 'bot');
          } else if(textoUsuario.includes('driver')) {
            contexto = null; esperandoEscolha = false;
            adicionarMensagem("Baixe e instale o driver mais recente para sua impressora no site do fabricante.", 'bot');
          } else if(textoUsuario.includes('fila de impressão')) {
            contexto = null; esperandoEscolha = false;
            adicionarMensagem("Limpe a fila de impressão no painel de controle para resolver travamentos.", 'bot');
          } else if(textoUsuario.includes('outro')) {
            contexto = null; esperandoEscolha = false;
            adicionarMensagem("Descreva seu problema com a impressora para que eu possa ajudar.", 'bot');
          } else {
            adicionarMensagem("Por favor, escolha uma das opções clicando nos links acima.", 'bot');
          }
          return;

        default:
          adicionarMensagem("Não entendi sua mensagem. Pode reformular ou escolher um dos tópicos principais? Ex: internet, lentidão, erro, hardware, software, vírus, impressora.", 'bot');
      }
    }

    // Evento para enviar mensagem
    inputArea.addEventListener('submit', (e) => {
      e.preventDefault();
      const texto = inputMsg.value.trim();
      if(!texto) return;
      adicionarMensagem(texto, 'user');
      processarMensagem(texto);
      inputMsg.value = '';
      inputMsg.focus();
    });

    // Mensagem inicial do bot
    adicionarMensagem("Olá! Sou seu assistente virtual. Como posso ajudar você hoje? Você pode dizer 'Oi' para começar.", 'bot');
  </script>
</body>
</html>
